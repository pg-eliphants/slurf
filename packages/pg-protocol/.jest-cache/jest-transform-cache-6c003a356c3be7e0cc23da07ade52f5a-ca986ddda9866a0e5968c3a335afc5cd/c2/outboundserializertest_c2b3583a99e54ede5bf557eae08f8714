bad3af8b292db6493a2f88a175adac51
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const strict_1 = require("node:assert/strict");
const serializer_1 = require("./serializer");
const buffer_list_1 = __importDefault(require("./testing/buffer-list"));
describe('serializer', () => {
    it('builds startup message', function () {
        const actual = serializer_1.serialize.startup({
            user: 'brian',
            database: 'bang'
        });
        strict_1.strict.deepEqual(actual, new buffer_list_1.default()
            .addInt16(3)
            .addInt16(0)
            .addCString('user')
            .addCString('brian')
            .addCString('database')
            .addCString('bang')
            .addCString('client_encoding')
            .addCString('UTF8')
            .addCString('')
            .join(true));
    });
    it('builds password message', function () {
        const actual = serializer_1.serialize.password('!');
        strict_1.strict.deepEqual(actual, new buffer_list_1.default().addCString('!').join(true, 'p'));
    });
    it('builds request ssl message', function () {
        const actual = serializer_1.serialize.requestSsl();
        const expected = new buffer_list_1.default().addInt32(80877103).join(true);
        strict_1.strict.deepEqual(actual, expected);
    });
    it('builds SASLInitialResponseMessage message', function () {
        const actual = serializer_1.serialize.sendSASLInitialResponseMessage('mech', 'data');
        strict_1.strict.deepEqual(actual, new buffer_list_1.default().addCString('mech').addInt32(4).addString('data').join(true, 'p'));
    });
    it('builds SCRAMClientFinalMessage message', function () {
        const actual = serializer_1.serialize.sendSCRAMClientFinalMessage('data');
        strict_1.strict.deepEqual(actual, new buffer_list_1.default().addString('data').join(true, 'p'));
    });
    it('builds query message', function () {
        var txt = 'select * from boom';
        const actual = serializer_1.serialize.query(txt);
        strict_1.strict.deepEqual(actual, new buffer_list_1.default().addCString(txt).join(true, 'Q'));
    });
    describe('parse message', () => {
        it('builds parse message', function () {
            const actual = serializer_1.serialize.parse({ text: '!' });
            var expected = new buffer_list_1.default().addCString('').addCString('!').addInt16(0).join(true, 'P');
            strict_1.strict.deepEqual(actual, expected);
        });
        it('builds parse message with named query', function () {
            const actual = serializer_1.serialize.parse({
                name: 'boom',
                text: 'select * from boom',
                types: []
            });
            var expected = new buffer_list_1.default()
                .addCString('boom')
                .addCString('select * from boom')
                .addInt16(0)
                .join(true, 'P');
            strict_1.strict.deepEqual(actual, expected);
        });
        it('with multiple parameters', function () {
            const actual = serializer_1.serialize.parse({
                name: 'force',
                text: 'select * from bang where name = $1',
                types: [1, 2, 3, 4]
            });
            var expected = new buffer_list_1.default()
                .addCString('force')
                .addCString('select * from bang where name = $1')
                .addInt16(4)
                .addInt32(1)
                .addInt32(2)
                .addInt32(3)
                .addInt32(4)
                .join(true, 'P');
            strict_1.strict.deepEqual(actual, expected);
        });
    });
    describe('bind messages', function () {
        it('with no values', function () {
            const actual = serializer_1.serialize.bind();
            var expectedBuffer = new buffer_list_1.default()
                .addCString('')
                .addCString('')
                .addInt16(0)
                .addInt16(0)
                .addInt16(0)
                .join(true, 'B');
            strict_1.strict.deepEqual(actual, expectedBuffer);
        });
        it('with named statement, portal, and values', function () {
            const actual = serializer_1.serialize.bind({
                portal: 'bang',
                statement: 'woo',
                values: ['1', 'hi', null, 'zing']
            });
            var expectedBuffer = new buffer_list_1.default()
                .addCString('bang') // portal name
                .addCString('woo') // statement name
                .addInt16(4)
                .addInt16(0)
                .addInt16(0)
                .addInt16(0)
                .addInt16(0)
                .addInt16(4)
                .addInt32(1)
                .add(Buffer.from('1'))
                .addInt32(2)
                .add(Buffer.from('hi'))
                .addInt32(-1)
                .addInt32(4)
                .add(Buffer.from('zing'))
                .addInt16(0)
                .join(true, 'B');
            strict_1.strict.deepEqual(actual, expectedBuffer);
        });
    });
    it('with custom valueMapper', function () {
        const actual = serializer_1.serialize.bind({
            portal: 'bang',
            statement: 'woo',
            values: ['1', 'hi', null, 'zing'],
            valueMapper: () => null
        });
        var expectedBuffer = new buffer_list_1.default()
            .addCString('bang') // portal name
            .addCString('woo') // statement name
            .addInt16(4)
            .addInt16(0)
            .addInt16(0)
            .addInt16(0)
            .addInt16(0)
            .addInt16(4)
            .addInt32(-1)
            .addInt32(-1)
            .addInt32(-1)
            .addInt32(-1)
            .addInt16(0)
            .join(true, 'B');
        strict_1.strict.deepEqual(actual, expectedBuffer);
    });
    it('with named statement, portal, and buffer value', function () {
        const actual = serializer_1.serialize.bind({
            portal: 'bang',
            statement: 'woo',
            values: ['1', 'hi', null, Buffer.from('zing', 'utf8')]
        });
        var expectedBuffer = new buffer_list_1.default()
            .addCString('bang') // portal name
            .addCString('woo') // statement name
            .addInt16(4) // value count
            .addInt16(0) // string
            .addInt16(0) // string
            .addInt16(0) // string
            .addInt16(1) // binary
            .addInt16(4)
            .addInt32(1)
            .add(Buffer.from('1'))
            .addInt32(2)
            .add(Buffer.from('hi'))
            .addInt32(-1)
            .addInt32(4)
            .add(Buffer.from('zing', 'utf-8'))
            .addInt16(0)
            .join(true, 'B');
        strict_1.strict.deepEqual(actual, expectedBuffer);
    });
    describe('builds execute message', function () {
        it('for unamed portal with no row limit', function () {
            const actual = serializer_1.serialize.execute();
            var expectedBuffer = new buffer_list_1.default().addCString('').addInt32(0).join(true, 'E');
            strict_1.strict.deepEqual(actual, expectedBuffer);
        });
        it('for named portal with row limit', function () {
            const actual = serializer_1.serialize.execute({
                portal: 'my favorite portal',
                rows: 100
            });
            var expectedBuffer = new buffer_list_1.default().addCString('my favorite portal').addInt32(100).join(true, 'E');
            strict_1.strict.deepEqual(actual, expectedBuffer);
        });
    });
    it('builds flush command', function () {
        const actual = serializer_1.serialize.flush();
        var expected = new buffer_list_1.default().join(true, 'H');
        strict_1.strict.deepEqual(actual, expected);
    });
    it('builds sync command', function () {
        const actual = serializer_1.serialize.sync();
        var expected = new buffer_list_1.default().join(true, 'S');
        strict_1.strict.deepEqual(actual, expected);
    });
    it('builds end command', function () {
        const actual = serializer_1.serialize.end();
        var expected = Buffer.from([0x58, 0, 0, 0, 4]);
        strict_1.strict.deepEqual(actual, expected);
    });
    describe('builds describe command', function () {
        it('describe statement', function () {
            const actual = serializer_1.serialize.describe({ type: 'S', name: 'bang' });
            var expected = new buffer_list_1.default().addChar('S').addCString('bang').join(true, 'D');
            strict_1.strict.deepEqual(actual, expected);
        });
        it('describe unnamed portal', function () {
            const actual = serializer_1.serialize.describe({ type: 'P' });
            var expected = new buffer_list_1.default().addChar('P').addCString('').join(true, 'D');
            strict_1.strict.deepEqual(actual, expected);
        });
    });
    describe('builds close command', function () {
        it('describe statement', function () {
            const actual = serializer_1.serialize.close({ type: 'S', name: 'bang' });
            var expected = new buffer_list_1.default().addChar('S').addCString('bang').join(true, 'C');
            strict_1.strict.deepEqual(actual, expected);
        });
        it('describe unnamed portal', function () {
            const actual = serializer_1.serialize.close({ type: 'P' });
            var expected = new buffer_list_1.default().addChar('P').addCString('').join(true, 'C');
            strict_1.strict.deepEqual(actual, expected);
        });
    });
    describe('copy messages', function () {
        it('builds copyFromChunk', () => {
            const actual = serializer_1.serialize.copyData(Buffer.from([1, 2, 3]));
            const expected = new buffer_list_1.default().add(Buffer.from([1, 2, 3])).join(true, 'd');
            strict_1.strict.deepEqual(actual, expected);
        });
        it('builds copy fail', () => {
            const actual = serializer_1.serialize.copyFail('err!');
            const expected = new buffer_list_1.default().addCString('err!').join(true, 'f');
            strict_1.strict.deepEqual(actual, expected);
        });
        it('builds copy done', () => {
            const actual = serializer_1.serialize.copyDone();
            const expected = new buffer_list_1.default().join(true, 'c');
            strict_1.strict.deepEqual(actual, expected);
        });
    });
    it('builds cancel message', () => {
        const actual = serializer_1.serialize.cancel(3, 4);
        const expected = new buffer_list_1.default().addInt16(1234).addInt16(5678).addInt32(3).addInt32(4).join(true);
        strict_1.strict.deepEqual(actual, expected);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXHJlcG9zXFxub2RlLXBvc3RncmVzXFxwYWNrYWdlc1xccGctcHJvdG9jb2xcXHNyY1xcb3V0Ym91bmQtc2VyaWFsaXplci50ZXN0LnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsK0NBQXNEO0FBQ3RELDZDQUF5QztBQUN6Qyx3RUFBK0M7QUFFL0MsUUFBUSxDQUFDLFlBQVksRUFBRSxHQUFHLEVBQUU7SUFDeEIsRUFBRSxDQUFDLHdCQUF3QixFQUFFO1FBQ3pCLE1BQU0sTUFBTSxHQUFHLHNCQUFTLENBQUMsT0FBTyxDQUFDO1lBQzdCLElBQUksRUFBRSxPQUFPO1lBQ2IsUUFBUSxFQUFFLE1BQU07U0FDbkIsQ0FBQyxDQUFDO1FBQ0gsZUFBTSxDQUFDLFNBQVMsQ0FDWixNQUFNLEVBQ04sSUFBSSxxQkFBVSxFQUFFO2FBQ1gsUUFBUSxDQUFDLENBQUMsQ0FBQzthQUNYLFFBQVEsQ0FBQyxDQUFDLENBQUM7YUFDWCxVQUFVLENBQUMsTUFBTSxDQUFDO2FBQ2xCLFVBQVUsQ0FBQyxPQUFPLENBQUM7YUFDbkIsVUFBVSxDQUFDLFVBQVUsQ0FBQzthQUN0QixVQUFVLENBQUMsTUFBTSxDQUFDO2FBQ2xCLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQzthQUM3QixVQUFVLENBQUMsTUFBTSxDQUFDO2FBQ2xCLFVBQVUsQ0FBQyxFQUFFLENBQUM7YUFDZCxJQUFJLENBQUMsSUFBSSxDQUFDLENBQ2xCLENBQUM7SUFDTixDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyx5QkFBeUIsRUFBRTtRQUMxQixNQUFNLE1BQU0sR0FBRyxzQkFBUyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUN2QyxlQUFNLENBQUMsU0FBUyxDQUFDLE1BQU0sRUFBRSxJQUFJLHFCQUFVLEVBQUUsQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQy9FLENBQUMsQ0FBQyxDQUFDO0lBRUgsRUFBRSxDQUFDLDRCQUE0QixF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QUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDbkcsZUFBTSxDQUFDLFNBQVMsQ0FBQyxNQUFNLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFDdkMsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxccmVwb3NcXG5vZGUtcG9zdGdyZXNcXHBhY2thZ2VzXFxwZy1wcm90b2NvbFxcc3JjXFxvdXRib3VuZC1zZXJpYWxpemVyLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3RyaWN0IGFzIGFzc2VydCB9IGZyb20gJ25vZGU6YXNzZXJ0L3N0cmljdCc7XHJcbmltcG9ydCB7IHNlcmlhbGl6ZSB9IGZyb20gJy4vc2VyaWFsaXplcic7XHJcbmltcG9ydCBCdWZmZXJMaXN0IGZyb20gJy4vdGVzdGluZy9idWZmZXItbGlzdCc7XHJcblxyXG5kZXNjcmliZSgnc2VyaWFsaXplcicsICgpID0+IHtcclxuICAgIGl0KCdidWlsZHMgc3RhcnR1cCBtZXNzYWdlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbnN0IGFjdHVhbCA9IHNlcmlhbGl6ZS5zdGFydHVwKHtcclxuICAgICAgICAgICAgdXNlcjogJ2JyaWFuJyxcclxuICAgICAgICAgICAgZGF0YWJhc2U6ICdiYW5nJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGFzc2VydC5kZWVwRXF1YWwoXHJcbiAgICAgICAgICAgIGFjdHVhbCxcclxuICAgICAgICAgICAgbmV3IEJ1ZmZlckxpc3QoKVxyXG4gICAgICAgICAgICAgICAgLmFkZEludDE2KDMpXHJcbiAgICAgICAgICAgICAgICAuYWRkSW50MTYoMClcclxuICAgICAgICAgICAgICAgIC5hZGRDU3RyaW5nKCd1c2VyJylcclxuICAgICAgICAgICAgICAgIC5hZGRDU3RyaW5nKCdicmlhbicpXHJcbiAgICAgICAgICAgICAgICAuYWRkQ1N0cmluZygnZGF0YWJhc2UnKVxyXG4gICAgICAgICAgICAgICAgLmFkZENTdHJpbmcoJ2JhbmcnKVxyXG4gICAgICAgICAgICAgICAgLmFkZENTdHJpbmcoJ2NsaWVudF9lbmNvZGluZycpXHJcbiAgICAgICAgICAgICAgICAuYWRkQ1N0cmluZygnVVRGOCcpXHJcbiAgICAgICAgICAgICAgICAuYWRkQ1N0cmluZygnJylcclxuICAgICAgICAgICAgICAgIC5qb2luKHRydWUpXHJcbiAgICAgICAgKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdidWlsZHMgcGFzc3dvcmQgbWVzc2FnZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zdCBhY3R1YWwgPSBzZXJpYWxpemUucGFzc3dvcmQoJyEnKTtcclxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKGFjdHVhbCwgbmV3IEJ1ZmZlckxpc3QoKS5hZGRDU3RyaW5nKCchJykuam9pbih0cnVlLCAncCcpKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdidWlsZHMgcmVxdWVzdCBzc2wgbWVzc2FnZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zdCBhY3R1YWwgPSBzZXJpYWxpemUucmVxdWVzdFNzbCgpO1xyXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkID0gbmV3IEJ1ZmZlckxpc3QoKS5hZGRJbnQzMig4MDg3NzEwMykuam9pbih0cnVlKTtcclxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2J1aWxkcyBTQVNMSW5pdGlhbFJlc3BvbnNlTWVzc2FnZSBtZXNzYWdlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbnN0IGFjdHVhbCA9IHNlcmlhbGl6ZS5zZW5kU0FTTEluaXRpYWxSZXNwb25zZU1lc3NhZ2UoJ21lY2gnLCAnZGF0YScpO1xyXG4gICAgICAgIGFzc2VydC5kZWVwRXF1YWwoYWN0dWFsLCBuZXcgQnVmZmVyTGlzdCgpLmFkZENTdHJpbmcoJ21lY2gnKS5hZGRJbnQzMig0KS5hZGRTdHJpbmcoJ2RhdGEnKS5qb2luKHRydWUsICdwJykpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2J1aWxkcyBTQ1JBTUNsaWVudEZpbmFsTWVzc2FnZSBtZXNzYWdlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbnN0IGFjdHVhbCA9IHNlcmlhbGl6ZS5zZW5kU0NSQU1DbGllbnRGaW5hbE1lc3NhZ2UoJ2RhdGEnKTtcclxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKGFjdHVhbCwgbmV3IEJ1ZmZlckxpc3QoKS5hZGRTdHJpbmcoJ2RhdGEnKS5qb2luKHRydWUsICdwJykpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2J1aWxkcyBxdWVyeSBtZXNzYWdlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0eHQgPSAnc2VsZWN0ICogZnJvbSBib29tJztcclxuICAgICAgICBjb25zdCBhY3R1YWwgPSBzZXJpYWxpemUucXVlcnkodHh0KTtcclxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKGFjdHVhbCwgbmV3IEJ1ZmZlckxpc3QoKS5hZGRDU3RyaW5nKHR4dCkuam9pbih0cnVlLCAnUScpKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdwYXJzZSBtZXNzYWdlJywgKCkgPT4ge1xyXG4gICAgICAgIGl0KCdidWlsZHMgcGFyc2UgbWVzc2FnZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc3QgYWN0dWFsID0gc2VyaWFsaXplLnBhcnNlKHsgdGV4dDogJyEnIH0pO1xyXG4gICAgICAgICAgICB2YXIgZXhwZWN0ZWQgPSBuZXcgQnVmZmVyTGlzdCgpLmFkZENTdHJpbmcoJycpLmFkZENTdHJpbmcoJyEnKS5hZGRJbnQxNigwKS5qb2luKHRydWUsICdQJyk7XHJcbiAgICAgICAgICAgIGFzc2VydC5kZWVwRXF1YWwoYWN0dWFsLCBleHBlY3RlZCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdidWlsZHMgcGFyc2UgbWVzc2FnZSB3aXRoIG5hbWVkIHF1ZXJ5JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb25zdCBhY3R1YWwgPSBzZXJpYWxpemUucGFyc2Uoe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ2Jvb20nLFxyXG4gICAgICAgICAgICAgICAgdGV4dDogJ3NlbGVjdCAqIGZyb20gYm9vbScsXHJcbiAgICAgICAgICAgICAgICB0eXBlczogW11cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHZhciBleHBlY3RlZCA9IG5ldyBCdWZmZXJMaXN0KClcclxuICAgICAgICAgICAgICAgIC5hZGRDU3RyaW5nKCdib29tJylcclxuICAgICAgICAgICAgICAgIC5hZGRDU3RyaW5nKCdzZWxlY3QgKiBmcm9tIGJvb20nKVxyXG4gICAgICAgICAgICAgICAgLmFkZEludDE2KDApXHJcbiAgICAgICAgICAgICAgICAuam9pbih0cnVlLCAnUCcpO1xyXG4gICAgICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnd2l0aCBtdWx0aXBsZSBwYXJhbWV0ZXJzJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb25zdCBhY3R1YWwgPSBzZXJpYWxpemUucGFyc2Uoe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ2ZvcmNlJyxcclxuICAgICAgICAgICAgICAgIHRleHQ6ICdzZWxlY3QgKiBmcm9tIGJhbmcgd2hlcmUgbmFtZSA9ICQxJyxcclxuICAgICAgICAgICAgICAgIHR5cGVzOiBbMSwgMiwgMywgNF1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHZhciBleHBlY3RlZCA9IG5ldyBCdWZmZXJMaXN0KClcclxuICAgICAgICAgICAgICAgIC5hZGRDU3RyaW5nKCdmb3JjZScpXHJcbiAgICAgICAgICAgICAgICAuYWRkQ1N0cmluZygnc2VsZWN0ICogZnJvbSBiYW5nIHdoZXJlIG5hbWUgPSAkMScpXHJcbiAgICAgICAgICAgICAgICAuYWRkSW50MTYoNClcclxuICAgICAgICAgICAgICAgIC5hZGRJbnQzMigxKVxyXG4gICAgICAgICAgICAgICAgLmFkZEludDMyKDIpXHJcbiAgICAgICAgICAgICAgICAuYWRkSW50MzIoMylcclxuICAgICAgICAgICAgICAgIC5hZGRJbnQzMig0KVxyXG4gICAgICAgICAgICAgICAgLmpvaW4odHJ1ZSwgJ1AnKTtcclxuICAgICAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbChhY3R1YWwsIGV4cGVjdGVkKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdiaW5kIG1lc3NhZ2VzJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGl0KCd3aXRoIG5vIHZhbHVlcycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc3QgYWN0dWFsID0gc2VyaWFsaXplLmJpbmQoKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBleHBlY3RlZEJ1ZmZlciA9IG5ldyBCdWZmZXJMaXN0KClcclxuICAgICAgICAgICAgICAgIC5hZGRDU3RyaW5nKCcnKVxyXG4gICAgICAgICAgICAgICAgLmFkZENTdHJpbmcoJycpXHJcbiAgICAgICAgICAgICAgICAuYWRkSW50MTYoMClcclxuICAgICAgICAgICAgICAgIC5hZGRJbnQxNigwKVxyXG4gICAgICAgICAgICAgICAgLmFkZEludDE2KDApXHJcbiAgICAgICAgICAgICAgICAuam9pbih0cnVlLCAnQicpO1xyXG4gICAgICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWRCdWZmZXIpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpdCgnd2l0aCBuYW1lZCBzdGF0ZW1lbnQsIHBvcnRhbCwgYW5kIHZhbHVlcycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc3QgYWN0dWFsID0gc2VyaWFsaXplLmJpbmQoe1xyXG4gICAgICAgICAgICAgICAgcG9ydGFsOiAnYmFuZycsXHJcbiAgICAgICAgICAgICAgICBzdGF0ZW1lbnQ6ICd3b28nLFxyXG4gICAgICAgICAgICAgICAgdmFsdWVzOiBbJzEnLCAnaGknLCBudWxsLCAnemluZyddXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB2YXIgZXhwZWN0ZWRCdWZmZXIgPSBuZXcgQnVmZmVyTGlzdCgpXHJcbiAgICAgICAgICAgICAgICAuYWRkQ1N0cmluZygnYmFuZycpIC8vIHBvcnRhbCBuYW1lXHJcbiAgICAgICAgICAgICAgICAuYWRkQ1N0cmluZygnd29vJykgLy8gc3RhdGVtZW50IG5hbWVcclxuICAgICAgICAgICAgICAgIC5hZGRJbnQxNig0KVxyXG4gICAgICAgICAgICAgICAgLmFkZEludDE2KDApXHJcbiAgICAgICAgICAgICAgICAuYWRkSW50MTYoMClcclxuICAgICAgICAgICAgICAgIC5hZGRJbnQxNigwKVxyXG4gICAgICAgICAgICAgICAgLmFkZEludDE2KDApXHJcbiAgICAgICAgICAgICAgICAuYWRkSW50MTYoNClcclxuICAgICAgICAgICAgICAgIC5hZGRJbnQzMigxKVxyXG4gICAgICAgICAgICAgICAgLmFkZChCdWZmZXIuZnJvbSgnMScpKVxyXG4gICAgICAgICAgICAgICAgLmFkZEludDMyKDIpXHJcbiAgICAgICAgICAgICAgICAuYWRkKEJ1ZmZlci5mcm9tKCdoaScpKVxyXG4gICAgICAgICAgICAgICAgLmFkZEludDMyKC0xKVxyXG4gICAgICAgICAgICAgICAgLmFkZEludDMyKDQpXHJcbiAgICAgICAgICAgICAgICAuYWRkKEJ1ZmZlci5mcm9tKCd6aW5nJykpXHJcbiAgICAgICAgICAgICAgICAuYWRkSW50MTYoMClcclxuICAgICAgICAgICAgICAgIC5qb2luKHRydWUsICdCJyk7XHJcbiAgICAgICAgICAgIGFzc2VydC5kZWVwRXF1YWwoYWN0dWFsLCBleHBlY3RlZEJ1ZmZlcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnd2l0aCBjdXN0b20gdmFsdWVNYXBwZXInLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc3QgYWN0dWFsID0gc2VyaWFsaXplLmJpbmQoe1xyXG4gICAgICAgICAgICBwb3J0YWw6ICdiYW5nJyxcclxuICAgICAgICAgICAgc3RhdGVtZW50OiAnd29vJyxcclxuICAgICAgICAgICAgdmFsdWVzOiBbJzEnLCAnaGknLCBudWxsLCAnemluZyddLFxyXG4gICAgICAgICAgICB2YWx1ZU1hcHBlcjogKCkgPT4gbnVsbFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZhciBleHBlY3RlZEJ1ZmZlciA9IG5ldyBCdWZmZXJMaXN0KClcclxuICAgICAgICAgICAgLmFkZENTdHJpbmcoJ2JhbmcnKSAvLyBwb3J0YWwgbmFtZVxyXG4gICAgICAgICAgICAuYWRkQ1N0cmluZygnd29vJykgLy8gc3RhdGVtZW50IG5hbWVcclxuICAgICAgICAgICAgLmFkZEludDE2KDQpXHJcbiAgICAgICAgICAgIC5hZGRJbnQxNigwKVxyXG4gICAgICAgICAgICAuYWRkSW50MTYoMClcclxuICAgICAgICAgICAgLmFkZEludDE2KDApXHJcbiAgICAgICAgICAgIC5hZGRJbnQxNigwKVxyXG4gICAgICAgICAgICAuYWRkSW50MTYoNClcclxuICAgICAgICAgICAgLmFkZEludDMyKC0xKVxyXG4gICAgICAgICAgICAuYWRkSW50MzIoLTEpXHJcbiAgICAgICAgICAgIC5hZGRJbnQzMigtMSlcclxuICAgICAgICAgICAgLmFkZEludDMyKC0xKVxyXG4gICAgICAgICAgICAuYWRkSW50MTYoMClcclxuICAgICAgICAgICAgLmpvaW4odHJ1ZSwgJ0InKTtcclxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWRCdWZmZXIpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3dpdGggbmFtZWQgc3RhdGVtZW50LCBwb3J0YWwsIGFuZCBidWZmZXIgdmFsdWUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc3QgYWN0dWFsID0gc2VyaWFsaXplLmJpbmQoe1xyXG4gICAgICAgICAgICBwb3J0YWw6ICdiYW5nJyxcclxuICAgICAgICAgICAgc3RhdGVtZW50OiAnd29vJyxcclxuICAgICAgICAgICAgdmFsdWVzOiBbJzEnLCAnaGknLCBudWxsLCBCdWZmZXIuZnJvbSgnemluZycsICd1dGY4JyldXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdmFyIGV4cGVjdGVkQnVmZmVyID0gbmV3IEJ1ZmZlckxpc3QoKVxyXG4gICAgICAgICAgICAuYWRkQ1N0cmluZygnYmFuZycpIC8vIHBvcnRhbCBuYW1lXHJcbiAgICAgICAgICAgIC5hZGRDU3RyaW5nKCd3b28nKSAvLyBzdGF0ZW1lbnQgbmFtZVxyXG4gICAgICAgICAgICAuYWRkSW50MTYoNCkgLy8gdmFsdWUgY291bnRcclxuICAgICAgICAgICAgLmFkZEludDE2KDApIC8vIHN0cmluZ1xyXG4gICAgICAgICAgICAuYWRkSW50MTYoMCkgLy8gc3RyaW5nXHJcbiAgICAgICAgICAgIC5hZGRJbnQxNigwKSAvLyBzdHJpbmdcclxuICAgICAgICAgICAgLmFkZEludDE2KDEpIC8vIGJpbmFyeVxyXG4gICAgICAgICAgICAuYWRkSW50MTYoNClcclxuICAgICAgICAgICAgLmFkZEludDMyKDEpXHJcbiAgICAgICAgICAgIC5hZGQoQnVmZmVyLmZyb20oJzEnKSlcclxuICAgICAgICAgICAgLmFkZEludDMyKDIpXHJcbiAgICAgICAgICAgIC5hZGQoQnVmZmVyLmZyb20oJ2hpJykpXHJcbiAgICAgICAgICAgIC5hZGRJbnQzMigtMSlcclxuICAgICAgICAgICAgLmFkZEludDMyKDQpXHJcbiAgICAgICAgICAgIC5hZGQoQnVmZmVyLmZyb20oJ3ppbmcnLCAndXRmLTgnKSlcclxuICAgICAgICAgICAgLmFkZEludDE2KDApXHJcbiAgICAgICAgICAgIC5qb2luKHRydWUsICdCJyk7XHJcbiAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbChhY3R1YWwsIGV4cGVjdGVkQnVmZmVyKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdidWlsZHMgZXhlY3V0ZSBtZXNzYWdlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGl0KCdmb3IgdW5hbWVkIHBvcnRhbCB3aXRoIG5vIHJvdyBsaW1pdCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc3QgYWN0dWFsID0gc2VyaWFsaXplLmV4ZWN1dGUoKTtcclxuICAgICAgICAgICAgdmFyIGV4cGVjdGVkQnVmZmVyID0gbmV3IEJ1ZmZlckxpc3QoKS5hZGRDU3RyaW5nKCcnKS5hZGRJbnQzMigwKS5qb2luKHRydWUsICdFJyk7XHJcbiAgICAgICAgICAgIGFzc2VydC5kZWVwRXF1YWwoYWN0dWFsLCBleHBlY3RlZEJ1ZmZlcik7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdmb3IgbmFtZWQgcG9ydGFsIHdpdGggcm93IGxpbWl0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb25zdCBhY3R1YWwgPSBzZXJpYWxpemUuZXhlY3V0ZSh7XHJcbiAgICAgICAgICAgICAgICBwb3J0YWw6ICdteSBmYXZvcml0ZSBwb3J0YWwnLFxyXG4gICAgICAgICAgICAgICAgcm93czogMTAwXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB2YXIgZXhwZWN0ZWRCdWZmZXIgPSBuZXcgQnVmZmVyTGlzdCgpLmFkZENTdHJpbmcoJ215IGZhdm9yaXRlIHBvcnRhbCcpLmFkZEludDMyKDEwMCkuam9pbih0cnVlLCAnRScpO1xyXG4gICAgICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWRCdWZmZXIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2J1aWxkcyBmbHVzaCBjb21tYW5kJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbnN0IGFjdHVhbCA9IHNlcmlhbGl6ZS5mbHVzaCgpO1xyXG4gICAgICAgIHZhciBleHBlY3RlZCA9IG5ldyBCdWZmZXJMaXN0KCkuam9pbih0cnVlLCAnSCcpO1xyXG4gICAgICAgIGFzc2VydC5kZWVwRXF1YWwoYWN0dWFsLCBleHBlY3RlZCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnYnVpbGRzIHN5bmMgY29tbWFuZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zdCBhY3R1YWwgPSBzZXJpYWxpemUuc3luYygpO1xyXG4gICAgICAgIHZhciBleHBlY3RlZCA9IG5ldyBCdWZmZXJMaXN0KCkuam9pbih0cnVlLCAnUycpO1xyXG4gICAgICAgIGFzc2VydC5kZWVwRXF1YWwoYWN0dWFsLCBleHBlY3RlZCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnYnVpbGRzIGVuZCBjb21tYW5kJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbnN0IGFjdHVhbCA9IHNlcmlhbGl6ZS5lbmQoKTtcclxuICAgICAgICB2YXIgZXhwZWN0ZWQgPSBCdWZmZXIuZnJvbShbMHg1OCwgMCwgMCwgMCwgNF0pO1xyXG4gICAgICAgIGFzc2VydC5kZWVwRXF1YWwoYWN0dWFsLCBleHBlY3RlZCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnYnVpbGRzIGRlc2NyaWJlIGNvbW1hbmQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaXQoJ2Rlc2NyaWJlIHN0YXRlbWVudCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc3QgYWN0dWFsID0gc2VyaWFsaXplLmRlc2NyaWJlKHsgdHlwZTogJ1MnLCBuYW1lOiAnYmFuZycgfSk7XHJcbiAgICAgICAgICAgIHZhciBleHBlY3RlZCA9IG5ldyBCdWZmZXJMaXN0KCkuYWRkQ2hhcignUycpLmFkZENTdHJpbmcoJ2JhbmcnKS5qb2luKHRydWUsICdEJyk7XHJcbiAgICAgICAgICAgIGFzc2VydC5kZWVwRXF1YWwoYWN0dWFsLCBleHBlY3RlZCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdkZXNjcmliZSB1bm5hbWVkIHBvcnRhbCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc3QgYWN0dWFsID0gc2VyaWFsaXplLmRlc2NyaWJlKHsgdHlwZTogJ1AnIH0pO1xyXG4gICAgICAgICAgICB2YXIgZXhwZWN0ZWQgPSBuZXcgQnVmZmVyTGlzdCgpLmFkZENoYXIoJ1AnKS5hZGRDU3RyaW5nKCcnKS5qb2luKHRydWUsICdEJyk7XHJcbiAgICAgICAgICAgIGFzc2VydC5kZWVwRXF1YWwoYWN0dWFsLCBleHBlY3RlZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnYnVpbGRzIGNsb3NlIGNvbW1hbmQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaXQoJ2Rlc2NyaWJlIHN0YXRlbWVudCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc3QgYWN0dWFsID0gc2VyaWFsaXplLmNsb3NlKHsgdHlwZTogJ1MnLCBuYW1lOiAnYmFuZycgfSk7XHJcbiAgICAgICAgICAgIHZhciBleHBlY3RlZCA9IG5ldyBCdWZmZXJMaXN0KCkuYWRkQ2hhcignUycpLmFkZENTdHJpbmcoJ2JhbmcnKS5qb2luKHRydWUsICdDJyk7XHJcbiAgICAgICAgICAgIGFzc2VydC5kZWVwRXF1YWwoYWN0dWFsLCBleHBlY3RlZCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdkZXNjcmliZSB1bm5hbWVkIHBvcnRhbCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc3QgYWN0dWFsID0gc2VyaWFsaXplLmNsb3NlKHsgdHlwZTogJ1AnIH0pO1xyXG4gICAgICAgICAgICB2YXIgZXhwZWN0ZWQgPSBuZXcgQnVmZmVyTGlzdCgpLmFkZENoYXIoJ1AnKS5hZGRDU3RyaW5nKCcnKS5qb2luKHRydWUsICdDJyk7XHJcbiAgICAgICAgICAgIGFzc2VydC5kZWVwRXF1YWwoYWN0dWFsLCBleHBlY3RlZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnY29weSBtZXNzYWdlcycsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpdCgnYnVpbGRzIGNvcHlGcm9tQ2h1bmsnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGFjdHVhbCA9IHNlcmlhbGl6ZS5jb3B5RGF0YShCdWZmZXIuZnJvbShbMSwgMiwgM10pKTtcclxuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWQgPSBuZXcgQnVmZmVyTGlzdCgpLmFkZChCdWZmZXIuZnJvbShbMSwgMiwgM10pKS5qb2luKHRydWUsICdkJyk7XHJcbiAgICAgICAgICAgIGFzc2VydC5kZWVwRXF1YWwoYWN0dWFsLCBleHBlY3RlZCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdidWlsZHMgY29weSBmYWlsJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBhY3R1YWwgPSBzZXJpYWxpemUuY29weUZhaWwoJ2VyciEnKTtcclxuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWQgPSBuZXcgQnVmZmVyTGlzdCgpLmFkZENTdHJpbmcoJ2VyciEnKS5qb2luKHRydWUsICdmJyk7XHJcbiAgICAgICAgICAgIGFzc2VydC5kZWVwRXF1YWwoYWN0dWFsLCBleHBlY3RlZCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGl0KCdidWlsZHMgY29weSBkb25lJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBhY3R1YWwgPSBzZXJpYWxpemUuY29weURvbmUoKTtcclxuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWQgPSBuZXcgQnVmZmVyTGlzdCgpLmpvaW4odHJ1ZSwgJ2MnKTtcclxuICAgICAgICAgICAgYXNzZXJ0LmRlZXBFcXVhbChhY3R1YWwsIGV4cGVjdGVkKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdidWlsZHMgY2FuY2VsIG1lc3NhZ2UnLCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgYWN0dWFsID0gc2VyaWFsaXplLmNhbmNlbCgzLCA0KTtcclxuICAgICAgICBjb25zdCBleHBlY3RlZCA9IG5ldyBCdWZmZXJMaXN0KCkuYWRkSW50MTYoMTIzNCkuYWRkSW50MTYoNTY3OCkuYWRkSW50MzIoMykuYWRkSW50MzIoNCkuam9pbih0cnVlKTtcclxuICAgICAgICBhc3NlcnQuZGVlcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG4iXSwidmVyc2lvbiI6M30=