{"file":"C:\\repos\\node-postgres\\packages\\pg-protocol\\src\\testing\\test-buffers.ts","mappings":"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","names":[],"sources":["C:\\repos\\node-postgres\\packages\\pg-protocol\\src\\testing\\test-buffers.ts"],"sourcesContent":["// https://www.postgresql.org/docs/current/protocol-message-formats.html\r\nimport BufferList from './buffer-list'\r\n\r\nconst buffers = {\r\n  readyForQuery: function () {\r\n    return new BufferList().add(Buffer.from('I')).join(true, 'Z')\r\n  },\r\n\r\n  authenticationOk: function () {\r\n    return new BufferList().addInt32(0).join(true, 'R')\r\n  },\r\n\r\n  authenticationCleartextPassword: function () {\r\n    return new BufferList().addInt32(3).join(true, 'R')\r\n  },\r\n\r\n  authenticationMD5Password: function () {\r\n    return new BufferList()\r\n      .addInt32(5)\r\n      .add(Buffer.from([1, 2, 3, 4]))\r\n      .join(true, 'R')\r\n  },\r\n\r\n  authenticationSASL: function () {\r\n    return new BufferList().addInt32(10).addCString('SCRAM-SHA-256').addCString('').join(true, 'R')\r\n  },\r\n\r\n  authenticationSASLContinue: function () {\r\n    return new BufferList().addInt32(11).addString('data').join(true, 'R')\r\n  },\r\n\r\n  authenticationSASLFinal: function () {\r\n    return new BufferList().addInt32(12).addString('data').join(true, 'R')\r\n  },\r\n\r\n  parameterStatus: function (name: string, value: string) {\r\n    return new BufferList().addCString(name).addCString(value).join(true, 'S')\r\n  },\r\n\r\n  backendKeyData: function (processID: number, secretKey: number) {\r\n    return new BufferList().addInt32(processID).addInt32(secretKey).join(true, 'K')\r\n  },\r\n\r\n  commandComplete: function (string: string) {\r\n    return new BufferList().addCString(string).join(true, 'C')\r\n  },\r\n\r\n  rowDescription: function (fields: any[]) {\r\n    fields = fields || []\r\n    var buf = new BufferList()\r\n    buf.addInt16(fields.length)\r\n    fields.forEach(function (field) {\r\n      buf\r\n        .addCString(field.name)\r\n        .addInt32(field.tableID || 0)\r\n        .addInt16(field.attributeNumber || 0)\r\n        .addInt32(field.dataTypeID || 0)\r\n        .addInt16(field.dataTypeSize || 0)\r\n        .addInt32(field.typeModifier || 0)\r\n        .addInt16(field.formatCode || 0)\r\n    })\r\n    return buf.join(true, 'T')\r\n  },\r\n\r\n  parameterDescription: function (dataTypeIDs: number[]) {\r\n    dataTypeIDs = dataTypeIDs || []\r\n    var buf = new BufferList()\r\n    buf.addInt16(dataTypeIDs.length)\r\n    dataTypeIDs.forEach(function (dataTypeID) {\r\n      buf.addInt32(dataTypeID)\r\n    })\r\n    return buf.join(true, 't')\r\n  },\r\n\r\n  dataRow: function (columns: any[]) {\r\n    columns = columns || []\r\n    var buf = new BufferList()\r\n    buf.addInt16(columns.length)\r\n    columns.forEach(function (col) {\r\n      if (col == null) {\r\n        buf.addInt32(-1)\r\n      } else {\r\n        var strBuf = Buffer.from(col, 'utf8')\r\n        buf.addInt32(strBuf.length)\r\n        buf.add(strBuf)\r\n      }\r\n    })\r\n    return buf.join(true, 'D')\r\n  },\r\n\r\n  error: function (fields: any) {\r\n    return buffers.errorOrNotice(fields).join(true, 'E')\r\n  },\r\n\r\n  notice: function (fields: any) {\r\n    return buffers.errorOrNotice(fields).join(true, 'N')\r\n  },\r\n\r\n  errorOrNotice: function (fields: any) {\r\n    fields = fields || []\r\n    var buf = new BufferList()\r\n    fields.forEach(function (field: any) {\r\n      buf.addChar(field.type)\r\n      buf.addCString(field.value)\r\n    })\r\n    return buf.add(Buffer.from([0])) // terminator\r\n  },\r\n\r\n  parseComplete: function () {\r\n    return new BufferList().join(true, '1')\r\n  },\r\n\r\n  bindComplete: function () {\r\n    return new BufferList().join(true, '2')\r\n  },\r\n\r\n  notification: function (id: number, channel: string, payload: string) {\r\n    return new BufferList().addInt32(id).addCString(channel).addCString(payload).join(true, 'A')\r\n  },\r\n\r\n  emptyQuery: function () {\r\n    return new BufferList().join(true, 'I')\r\n  },\r\n\r\n  portalSuspended: function () {\r\n    return new BufferList().join(true, 's')\r\n  },\r\n\r\n  closeComplete: function () {\r\n    return new BufferList().join(true, '3')\r\n  },\r\n\r\n  copyIn: function (cols: number) {\r\n    const list = new BufferList()\r\n      // text mode\r\n      .addByte(0)\r\n      // column count\r\n      .addInt16(cols)\r\n    for (let i = 0; i < cols; i++) {\r\n      list.addInt16(i)\r\n    }\r\n    return list.join(true, 'G')\r\n  },\r\n\r\n  copyOut: function (cols: number) {\r\n    const list = new BufferList()\r\n      // text mode\r\n      .addByte(0)\r\n      // column count\r\n      .addInt16(cols)\r\n    for (let i = 0; i < cols; i++) {\r\n      list.addInt16(i)\r\n    }\r\n    return list.join(true, 'H')\r\n  },\r\n\r\n  copyData: function (bytes: Buffer) {\r\n    return new BufferList().add(bytes).join(true, 'd')\r\n  },\r\n\r\n  copyDone: function () {\r\n    return new BufferList().join(true, 'c')\r\n  },\r\n}\r\n\r\nexport default buffers\r\n"],"version":3}